/*!
* PitchPrint - v8.3.0 - Auto-compiled on this 9th day of February in the year of our Lord 2017 
* @author SynergicLabs
*/var PPCLIENT=PPCLIENT||{version:"8.3.0",readyFncs:[]};!function(a){"use strict";if(!jQuery)throw new Error("jQuery required for PitchPrint!");var b=jQuery,c=a.PPCLIENT;c.vars||(c.vars={});var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=".image,#product-photo-container,.product-left-column,.main-image,.product-photo-container,.featured,#image-block,.product-single-photos,.product_slider,#product-image,.photos",t=".single_add_to_cart_button,.kad_add_to_cart,.addtocart,#add-to-cart,.add_to_cart,#add,#AddToCart,#product-add-to-cart,#add_to_cart,#button-cart",u=".images",v=".product_image,.images",w=".thumbnails,.thumbs,.flex-control-thumbs,.more-view-wrapper,#views_block",x=".thumbnails,.image-container,.product-gallery",y=".image,.featured,.zoom,product-photo-container",z="#_w2p_set_option,#web2print_option_value";c.init=function(){if(!c.vars.initialized&&c.vars.apiBase){if(d=c.vars,c.loadStyle(),d.isMobile=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),"-1"!==d.designId&&"0"!==d.designId||(d.designId=""),d.isCategory=!!d.designId&&(!!d.designId.length&&("*"===d.designId[0]&&"edit"!==d.mode)),d.isCategory&&(d.config.showOnStartup=!1),d.designStack={},d.inline=d.config.inlineSelector||"",d.isInline=d.inline.length&&b(d.inline).length&&!d.isMobile,d.thumbsSrc="oc"===d.client?"image/data/files/":"images/files/",c.cleanup(),c.createUiButtons(),d.projectId&&!isNaN(parseInt(d.previews))){for(var a=[],e=parseInt(d.previews),f=0;f<e;f++)a.push(d.projectId+"_"+(f+1)+".jpg");c.updatePreviews(a,d.rscBase+"images/previews/",!1),c.isValidPP(d.cValues)&&"edit"===d.mode&&(d.designId=JSON.parse(decodeURIComponent(d.cValues)).designId)}else"upload"===d.mode&&c.isValidPP(d.cValues)&&c.updatePreviews(JSON.parse(decodeURIComponent(d.cValues)).previews,"",!1);c.setBtnPref(),c.loadLang(),d.initialized=!0}},c.cleanup=function(){switch(d.client){case"ps":b("#customizationForm").parent().hide(),b("#header .shopping_cart a:first").hover(function(){(ajaxCart.nb_total_products>0||parseInt(b(".ajax_cart_quantity").html())>0)&&b("li[name=customization]").each(function(){var a=b(this);a.text().indexOf("%22")&&a.html(a.children()[0]).append(d.lang.design)})})}},c.sortCart=function(){var a,e;switch(d.client){case"wp":b(".pp-cart-label").each(function(){a=b(this),e=JSON.parse(decodeURIComponent(a.prop("id"))),a.attr("pp-lang","p"===e.type?"design":"file_upload"),d.lang&&a.text(d.lang["p"===e.type?"design":"file_upload"])}),b(".pp-cart-data").each(function(){a=b(this),e=JSON.parse(decodeURIComponent(a.prop("id"))),c.isCheckoutPage?(a.parent().append('<img src="'+(e.previews?e.previews[0]:d.rscBase+"images/previews/"+e.projectId+"_1.jpg")+'" style="width:90px">'),a.remove()):"p"===e.type?(a.attr("pp-lang","duplicate_design"),d.lang&&a.text(d.lang.duplicate_design)):(a.attr("pp-lang","button_label_ok").attr("href","").css("pointer-events","none").removeClass("button"),d.lang&&a.text(d.lang.button_label_ok))});break;case"oc":b("span[pp-value]").each(function(){var a=b(this);if(""!==a.attr("pp-value").trim()){var c,e,f,g=a.attr("pp-value").trim(),h=JSON.parse(decodeURIComponent(g));a.attr("pp-image")?(c=a.attr("pp-image").trim(),"p"===h.type?(b(a.closest("table").find("img[src='"+c+"']")[0]).attr("src",d.rscBase+"images/previews/"+h.projectId+"_1.jpg").css("width","90px"),a.parent().html('<span pp-lang="design" >'+(d.lang?d.lang.design:"")+'</span>: &nbsp;&nbsp; <a pp-lang="duplicate_design" href="#" id="'+g+'">'+(d.lang?d.lang.duplicate_design:"")+"</a>")):(b(a.closest("table").find("img[src='"+c+"']")[0]).attr("src",h.previews[0]).css("width","90px"),a.parent().html('<span pp-lang="file_upload" >'+(d.lang?d.lang.file_upload:"")+'</span>: &nbsp;&nbsp; <img style="width:14px; height:14px" src="'+d.cdnBase+'images/ok.png" >'))):(f=a.parent().html('<span pp-lang="'+("p"===h.type?"design":"file_upload")+'" >'+(d.lang?d.lang["p"===h.type?"design":"file_upload"]:"")+'</span>: &nbsp;&nbsp; <img style="width:14px; height:14px" src="'+d.cdnBase+'images/ok.png" >'),e="p"===h.type?d.rscBase+"images/previews/"+h.projectId+"_1.jpg":h.previews[0],f.html('<img style="margin-top:5px; border: 1px #eee solid;" src="'+e+'" width="100" >'))}});break;case"ps":var f,a,e,g;b("li").each(function(){if(a=b(this),(a.html().indexOf("@PP@")>-1||a.html().indexOf("%7B%22")>-1&&a.html().indexOf("%22%7D")>-1)&&(f="<div>",g=a.html().split(":").pop().trim(),e=decodeURIComponent(g),c.isValidPP(e))){if(e=JSON.parse(e),"p"===e.type&&e.numPages){f+='<div style="padding:5px"><a href="#" id="'+g+'" pp-lang="duplicate_design">'+(d.lang?d.lang.duplicate_design:"")+"</a></div>";for(var h=0;h<e.numPages;h++)f+='<a class="ppc-ps-img"><img src="'+d.rscBase+"images/previews/"+e.projectId+"_"+(h+1)+'.jpg" class="pp-90thumb" ></a>'}else e.previews.forEach(function(a){f+='<a class="ppc-ps-img"><img src="'+a+'" class="pp-90thumb" ></a>'});a.html(f+"</div>")}})}b('[pp-lang="duplicate_design"]').click(function(a){a.preventDefault();var e=b(this);e.removeClass("button").html('<img src="'+d.cdnBase+'images/loaders/spinner.svg" class="ppc-ldr" >'),c.duplicateProject(e.prop("id"))})},c.validate=function(a){c.vars.validationData||(d||(d=c.vars),c.comm(d.apiBase+"validate",function(e){e.error?c.alert(e):(d.validationData=e.validation,d.config=e.config,d.connectsid=e.validation.server.urlToken,localStorage.removeItem("pitchPrintTempSave"),d.config.customJs&&b("<script>"+d.config.customJs+"</script>").appendTo("head"),d.config.customCss&&b("<style>"+d.config.customCss+"</style>").appendTo("head"),"function"==typeof a?a():c.afterValidation?c[c.afterValidation]():c.init())},function(a){c.alert(a)},{userId:d.userId,apiKey:d.apiKey,client:d.client,version:c.version,config:!0,tempProject:localStorage.getItem("pitchPrintTempSave")},"POST","json",!0))},c.loadLang=function(a){d||(d=c.vars),d.langCode&&"br"===d.langCode.toLowerCase()&&(d.langCode="pt-br"),c.comm(d.cdnBase+d.buildPath+"lang/"+(d.langCode||"en").toLowerCase(),function(b){if(d.lang="function"==typeof d.functions.onLanguageLoaded?d.functions.onLanguageLoaded(b):b,c.langEdits)for(var e in c.langEdits)d.lang[e]=c.langEdits[e];c.syncLang(),a||c.initEditor()},function(a){throw new Error("Error loading language file")},null,"GET","json")},c.comm=function(a,c,d,e,f,g,h){b.ajax({url:a,data:e,type:f||"POST",dataType:g||"json",success:c,error:d,xhrFields:{withCredentials:h}})},c.syncLang=function(){b("[pp-lang]").each(function(){"INPUT"==this.tagName.toUpperCase()?b(this).prop("value",d.lang[b(this).attr("pp-lang")]):b(this).text(d.lang[b(this).attr("pp-lang")])})},c.initEditor=function(){d.apiKey&&d.designId&&(c.designer=new pprint.designer({apiKey:d.apiKey,apiBase:d.apiBase,cdnBase:d.cdnBase,rscBase:d.rscBase,buildPath:d.buildPath,parentDiv:d.isInline?"#pp_inline_div":void 0,mode:d.mode,lang:d.lang,userId:d.userId,product:d.product,autoSave:d.autoSave,design:d.design,designMode:!1,designId:d.isCategory?void 0:d.designId,designCat:d.isCategory?d.designId:void 0,projectId:d.projectId,autoInitialize:!d.isCategory,isUserproject:!1,isAdmin:!1,langCode:d.langCode,client:d.client,userData:d.userData,isMobile:d.isMobile,validationData:d.validationData,config:d.config,overrides:c.overrides,autoShow:"edit"!==d.mode&&d.config.showOnStartup}),c.designer.events.on("app-shown",c.onShown),c.designer.events.on("app-closed",c.onClose),c.designer.events.on("project-saved",c.onSave),c.designer.events.on("lib-ready",c.onLibReady),c.vars.validationData?c.onValidated():c.designer.events.on("app-validated",c.onValidated),c.designer.events.on("app-client-pageCount",c.pageCountChanged),c.designer.events.on("app-client-templateChange",c.templateChanged),c.designer.events.on("app-client-canvasResized",c.canvasResized),"function"==typeof a.ppDesignerInitialized&&a.ppDesignerInitialized(c.designer))},c.onClose=function(){return d.editorVisible=!1,"function"==typeof d.functions.onClose?d.functions.onClose():("new"===d.mode?e.show():(f.show(),d.pdfDownload&&h.length&&h.show()),void(d.enableUpload?g.show():g.hide()))},c.onShown=function(){return d.editorShown=d.editorVisible=!0,"function"==typeof d.functions.onShown?d.functions.onShown():(e.hide(),f.hide(),g.hide(),void(h&&h.hide()))},c.onSave=function(a){var e=a.data;if("function"==typeof d.functions.onSave)return d.functions.onSave(e);d.mode="edit",d.projectSource=e.source,d.projectId=e.projectId,d.numPages=e.numPages,d.previews=e.previews,d.pdfDownload=e.pdfDownload,d.isCategory=!1,e.meta.records&&b("[name='quantity'],[name='qty']").val(e.meta.records).change().focus(),e.meta.ppCanvasAdjustment&&c.onCaUpdate(e.meta.ppCanvasAdjustment);var f=encodeURIComponent(JSON.stringify({projectId:e.projectId,numPages:e.numPages,meta:e.meta,userId:d.userId,product:d.product,type:"p",designTitle:e.source.title,designId:e.source.designId}));"sp"===d.client&&b("#_pitchprint").length?b("#_pitchprint").val(e.projectId):b("#_w2p_set_option,#web2print_option_value,#"+d.ocInputOption).length&&b("#_w2p_set_option,#web2print_option_value,#"+d.ocInputOption).val(f),c.saveSess({values:f}),setTimeout(function(){c.updatePreviews(e.previews,"",!1),d.isInline&&d.config.retainImages&&c.collapseEditor()},2e3),c.setBtnPref(!0),c.initPdfDownload(),d.dontCloseApp?c.designer.resume():c.designer.close(d.isInline),"function"==typeof d.functions.onAfterSave&&d.functions.onAfterSave(e)},c.templateChanged=function(a){"function"==typeof d.functions.templateChanged&&d.functions.templateChanged(a.data)},c.pageCountChanged=function(a){"function"==typeof d.functions.pageCountChanged&&d.functions.pageCountChanged(a.data)},c.canvasResized=function(a){"function"==typeof d.functions.canvasResized&&d.functions.canvasResized(a.data)},c.onCaUpdate=function(a){if(a.values.length)if("function"==typeof d.functions.canvasAdjustment)d.functions.canvasAdjustment(a);else if(b('label:contains("ppCanvasAdjustment")').length||b("#ppcanvasadjustment").length){var c,e,f,g,h=b("#ppcanvasadjustment").length?"ppcanvasadjustment":b('label:contains("ppCanvasAdjustment")').attr("for"),i=b("#"+h);b("#"+h+" > option").each(function(){c=this.text.split("(")[0].split(" ").join(""),a.isCustom&&c.indexOf("-")>0&&2===c.split("-").length?(g=parseFloat(a.values[0]),f=parseFloat(c.split("-")[0]),e=parseFloat(c.split("-")[1]),g>=f&&g<=e&&i.val(this.value).change()):c.indexOf("x")>0&&2===c.split("x").length&&a.values[0].toLowerCase()==c.toLowerCase()&&i.val(this.value).change()})}},c.initPdfDownload=function(){d.pdfDownload=c.designer.getPdfDownload(),"edit"===d.mode&&d.pdfDownload&&(c.comm(d.apiBase+"pdf-download",function(a){h.removeAttr("disabled").html(d.lang.pdf_download||"Download PDF File").attr("href",a.url)},function(a){c.alert(a)},{connectsid:d.connectsid,id:d.projectId,type:"pdf"},"post","json",!0),h.show().attr("disabled","disabled").html('<img src="'+d.cdnBase+'images/loaders/spinner.svg" height="24" >'))},c.onLibReady=function(){d.loadingCatLib&&(b.unblockUI(),d.loadingCatLib=!1,c.onReady())},c.onReady=function(){"edit"!==d.mode&&e.removeAttr("disabled").html(d.lang.custom_design)},c.loadStyle=function(){var a=document.createElement("link");a.rel="stylesheet",a.href=d.cdnBase+d.buildPath+"styles/client.css",document.head.appendChild(a)},c.createUiButtons=function(){"ps"===d.client&&b("#add_to_cart,.product-add-to-cart").parent().prepend('<div class="ppc-main-btn-sec" id="pp_main_btn_sec"></div>'),"sp"===d.client&&b("#pp_main_btn_sec").html("");var a="sp"===d.client?"a":"button";if("oc"===d.client){d.ocInputOption="input-option"+d.ppOptionId,z+=",#"+d.ocInputOption;var l=b('<div id="pp_main_btn_sec" class="form-group required"> <input type="hidden" id="'+d.ocInputOption+'" name="option['+d.ppOptionId+']" value="'+(d.cValues||"")+'" />');1===d.ocVersion?b("#button-cart").length?b("#button-cart").parent().prepend(l):b(".options").length&&b(".options").prepend(l):b("#pp_main_btn_sec").length||!b("#product").length&&!b("#button-cart").length||(b("#button-cart").length?b("#button-cart").parent().prepend(l):b(b("#product").children("h3")[0]).length?l.insertAfter(b(b("#product").children("h3")[0])):b("#product").prepend(l))}return k=b("#pp_main_btn_sec"),k.length?(j=b('<select class="ppc-main-ui form-control"><option pp-lang="pick_design" value="0"></option></select>').appendTo(k).change(c.setSelectDesign),e=b("<"+a+' class="ppc-main-ui btn btn-warning btn-block button" pp-lang="custom_design" class="ppc-pointer" type="button" ></'+a+">").appendTo(k).click(c.showDesigner),f=b('<input class="ppc-main-ui btn btn-success btn-block button" pp-lang="edit_design" type="button" />').appendTo(k).click(c.editDesign),h=b('<a target="_blank" class="ppc-main-ui btn btn-success btn-block button" pp-lang="pdf_download" type="button"></a>').appendTo(k),i=b('<input class="ppc-main-ui btn btn-default btn-block button" pp-lang="start_over" type="button" />').appendTo(k).click(c.clearDesign),g=b('<input class="ppc-main-ui btn btn-default btn-block button" pp-lang="upload_files" type="button" />').appendTo(k).click(c.showUpload),void setTimeout(function(){b('label:contains("ppCanvasAdjustment")').length&&b('label:contains("ppCanvasAdjustment")').parent().hide(),b("#ppcanvasadjustment").length&&b("#ppcanvasadjustment").parent().parent().hide()},1e3)):void c.alert("Could not create main button div")},c.editDesign=function(){d.editorShown?c.designer.resume():c.showDesigner(),c.expandEditor(),f.hide()},c.showDesigner=function(){d.isInline?(d.config.showOnStartup||c.expandEditor(),setTimeout(function(){c.designer.show()},1e3),e.hide()):c.designer.show()},c.expandEditor=function(){l&&l.length&&(TweenLite.to(l,.4,{height:b(window).height()-150,ease:Power2.easeOut}),c.scrollInline())},c.scrollInline=function(){d.isInline&&l&&b("html, body").animate({scrollTop:l.offset().top-(d.ppScrollTop||10)},300)},c.setSelectDesign=function(){if("0"!=j.val()){var a=j.val(),f=d.designStack[a].id,g=c.designer.getModel();d.defaultImages||d.config.retainImages||(d.defaultImages=b(u).children().detach()),c.updatePreviews(a,d.rscBase+"images/designs/",!0),e.show().attr("disabled","disabled"),g.vals.designId=f,g.vals.mode="new",d.editorShown?(c.comm(d.apiBase+"fetch-design",function(a){a.error?c.alert(d.lang.error_loading_design):c.designer.loadDesign(a.design),b.unblockUI()},function(a){c.alert(d.lang.error_loading_design),b.unblockUI()},{connectsid:d.connectsid,designId:f},"post","json",!0),c.showBusy()):c.designer.setLib()!==!0&&(d.loadingCatLib=!0,c.showBusy())}else d.defaultImages&&!d.config.retainImages&&b(u).empty().append(d.defaultImages),d.defaultImages=void 0,e.hide()},c.setBtnPref=function(a){if("function"==typeof d.functions.customSetBtnPref)return d.functions.customSetBtnPref();if(d.config.customizationRequired&&"new"==d.mode?b(t).hide():b(t).show(),b(".ppc-main-ui").hide(),d.isInline){switch(d.client){case"wp":d.config.retainImages||b(".single-product-main-image").remove()}a||(b("#pp_inline_div").length||(b(d.inline).length?l=b('<div class="pp-inline-div" id="pp_inline_div"><img class="pp-inline-div-loader" src="'+d.cdnBase+'images/loaders/spinner.svg" ></div>').prependTo(b(d.inline).first()):(d.inline="",d.isInline=!1)),d.config.showOnStartup?TweenLite.to(l,.6,{height:b(window).height()-150,ease:Power2.easeOut,onComplete:function(){c.scrollInline()}}):l.height(0))}switch(d.mode){case"new":d.isCategory?j.show().attr("disabled","disabled"):d.isInline&&d.config.showOnStartup||!d.designId?e.hide():e.show().attr("disabled","disabled").html('<img src="'+d.cdnBase+'images/loaders/spinner.svg" class="ppc-btn-ldr" >'),d.enableUpload?g.show():g.hide();break;case"edit":d.projectId&&(f.show(),i.show());break;case"upload":e.hide(),g.show().removeClass("btn-default").addClass("btn-success").attr("pp-lang","files_ok"),i.show()}},c.processCatModules=function(a,d){if(a){var e=JSON.parse(a),f=!1,g=c.designer.getModel();return g.runtime.sources.extModules||(g.runtime.sources.extModules={}),b.each(e,function(a,b){g.runtime.sources.extModules[a]=b,("ds"===a||b.overwriteCatSelector)&&(g.vals.designId=b.default||d[0].id,"Pick default design"!==g.vals.designId&&"0"!==g.vals.designId||(g.vals.designId=d[0].id),c.designer.loadLib(),f=!0)}),f}},c.fetchDesigns=function(a){d.isCategory&&(a&&(d.connectsid=a.server.connectsid),c.comm(d.apiBase+"fetch-cat-details",function(a){d.designStack={},a.error||(a.designs.forEach(function(a){j.append('<option value="'+a.id+'">'+a.title+"</option>"),d.designStack[a.id]=a}),c.designer&&(c.designer.getModel().vals.designStack=d.designStack),c.processCatModules(a.modules,a.designs)?(j.change().hide(),d.config.showOnStartup||e.show()):j.removeAttr("disabled").change())},function(a){c.alert(a)},{categoryId:d.designId.substr(1),connectsid:d.connectsid},"post","json",!0))},c.onValidated=function(){"edit"!==d.mode&&e&&e.removeAttr("disabled").html(d.lang.custom_design),c.fetchDesigns()},c.showUpload=function(){m||c.createUpload(),d.idx=0,d.uploadStack=[],d.uploadArr=[],p.empty(),c.showModal(m),c.checkUploads()},c.createUpload=function(){function a(){var a,e,f=[],g=[];d.uploadStack.forEach(function(a){a.thumbnailUrl||(a.thumbnailUrl=(d.pluginRoot||"")+d.thumbsSrc+a.url.split(".").pop().toLowerCase()+".png"),f.push(a.thumbnailUrl),g.push(a.url)}),d.mode="upload","sp"===d.client&&(a="u_"+d.uniqueId),e=encodeURIComponent(JSON.stringify({projectId:a,files:g,previews:f,meta:{},userId:d.userId,product:d.product,type:"u"})),"sp"===d.client&&b("#_pitchprint").length?b("#_pitchprint").val(a):b(z).length&&b(z).val(e),c.saveSess({values:e,isUpload:!0,projectId:a,productId:d.product.id}),c.updatePreviews(f,"",!1),c.setBtnPref(!0)}m=b('<div class="ppc-upload-panel"><div class="ppc-upload-title"><span>'+d.lang.upload_your_files+'</span></div><div class="ppc-upload-top-btn" ><span>'+d.lang.add_files+'</span> <input class="ppc-upload-input" id="ppc-upload-input" type="file" name="files[]" multiple=""></div><div class="ppc-upload-stack" id="ppc-upload-stack"></div> <div><input type="button" id="ppc-start-upload-btn" value="&#10003; '+d.lang.submit_tip+'" /> &nbsp;&nbsp; <input type="button" id="ppc-stop-upload-btn" value="&#x02717; '+d.lang.button_label_cancel+'" /></div>').appendTo(b("body")).hide(),n=b("#ppc-start-upload-btn").click(c.plsUpload),o=b("#ppc-stop-upload-btn").click(c.cancelUpload),p=b("#ppc-upload-stack");var e=b('<img src="'+d.rscBase+'images/cross.png" class="ppc-upload-remove" >').click(function(){var a=b(this).data();a.context.remove(),a.abort(),d.uploadArr[a.idx]=null,a=null,c.checkUploads()});b("#ppc-upload-input").fileupload({url:d.uploadUrl,dataType:"json",autoUpload:!1,dropZone:p,pasteZone:null,singleFileUploads:!0,sequentialUploads:!0,maxFileSize:5e7,disableImageResize:/Android(?!.*Chrome)|Opera/.test(window.navigator.userAgent),previewMaxWidth:175,previewMaxHeight:175,previewCrop:!0,formData:{convert:!0}}).on("fileuploadadd",function(a,c){c.context=b('<div class="ppc-upload-thumb-div" ><div class="ppc-upload-thumb">'+c.files[0].name+"</div></div>").prependTo(p)}).on("fileuploadprocessalways",function(a,f){var g=f.files[f.index],h=b(f.context);f.files.error?b(f.context).remove():(g.preview?h.prepend(g.preview):h.prepend(b('<img src="'+(d.pluginRoot||"")+d.thumbsSrc+g.name.split(".").pop().toLowerCase()+'.png" class="ppc-upload-thumb-img" />')),f.idx=d.idx,b(f.context).append(e.clone(!0).data(f)),d.uploadArr.push(f),d.idx++,c.checkUploads())}).on("fileuploaddone",function(e,f){b.each(f.result.files,function(e,f){f.url?(d.uploadStack.push(f),d.uploadArr.length>0?c.plsUpload():(b.unblockUI(),a())):f.error&&(c.alert(d.lang.upload_error),b.unblockUI())})}).on("fileuploadprogressall",function(a,b){r.circleProgress("value",b.loaded/b.total)}).on("fileuploadfail",function(a,e){c.alert(d.lang.upload_error),b.unblockUI()}),p.on("dragleave",function(a){b(a.target).css("background-color","#ddd")}).on("dragenter",function(a){b(a.target).css("background-color","#BFBFBF")}).on("drop",function(a){b(a.target).css("background-color","#ddd")}),"sp"!==d.client||d.uniqueId||c.comm(d.randUrl,function(a){d.uniqueId=a.key},null,null,"GET"),m=m.detach()},c.cancelUpload=function(){c.hideUpload()},c.hideUpload=function(){m=m.detach(),b.unblockUI()},c.plsUpload=function(a){if(a&&(d.editorVisible||(c.hideUpload(),c.showUploadProgress())),c.checkUploads())for(var b,e=d.uploadArr.length,f=0;f<e;f++)if(b=d.uploadArr.pop())return void b.submit()},c.showUploadProgress=function(){q||(q=b('<div class="ppc-upload-progress-parent"><div id="ppc-upload-prgs" class="ppc-upload-progress" ></div>').appendTo(b("body")),r=b("#ppc-upload-prgs").circleProgress({value:0,size:80,thickness:10,fill:{color:"#EEEEEE"}}),q=q.detach()),c.showModal(q)},c.checkUploads=function(){for(var a=0;a<d.uploadArr.length;a++)if(null!==d.uploadArr[a])return n.css("opacity",1).prop("disabled",!1),!0;return n.css("opacity",.3).prop("disabled",!0),!1},c.updatePreviews=function(a,c,e){if(!d.config.retainImages){var f,g,h,i,j=Math.random();if(e===!0){if(g=[],h=d.designStack[a],!h)return;for(a=[],i=0;i<h.pages;i++)a.push(h.id+"_"+(i+1)+".jpg")}if("function"==typeof d.functions.customImageSwap)return d.functions.customImageSwap(a,c);switch(d.client){case"wp":"function"==typeof b().magnificPopup?(f='<a href="'+c+a[0]+'" itemprop="image" class="woocommerce-main-image zoom" title="'+d.product.name+'" rel="lightbox"><img src="'+c+a[0]+'" class="attachment-shop_single wp-post-image ppc-img-width" title="'+d.product.name+'"></a>',b(v).last().html(f),f="",a.forEach(function(a,b){b>0&&(f+='<a href="'+c+a+"?rand="+j+'" class="zoom first" title="'+d.product.name+'" rel="lightbox"><img class="ppc-preview-thumb" src="'+c+a+"?rand="+j+'" class="attachment-shop_thumbnail" title="'+d.product.name+'"></a>')}),b(w).html(f),b("a[rel^='lightbox']").magnificPopup({type:"image",gallery:{enabled:!0}}),b(".kad-light-gallery").each(function(){b(this).find('a[rel^="lightbox"]').magnificPopup({type:"image",gallery:{enabled:!0},image:{titleSrc:"title"}})})):(f='<a href="'+c+a[0]+"?rand="+j+'" itemprop="image" class="woocommerce-main-image zoom" title="'+d.product.name+'" rel="prettyPhoto[product-gallery]"><img src="'+c+a[0]+"?rand="+j+'" class="attachment-shop_single wp-post-image ppc-img-width" title="'+d.product.name+'"></a>',a.forEach(function(a,b){f+=' <div class="thumbnails"><a href="'+c+a+"?rand="+j+'" class="zoom first" title="'+d.product.name+'" rel="prettyPhoto[product-gallery]"><img width="150" height="90" src="'+c+a+"?rand="+j+'" class="attachment-shop_thumbnail" title="'+d.product.name+'"></a></div>'}),b(v).html(f),void 0!==b.prettyPhoto&&b("a[rel='prettyPhoto[product-gallery]']").prettyPhoto());break;case"oc":b(x).length&&b.magnificPopup?(f='<li><a class="thumbnail product-image" rel="magnific" href="'+c+a[0]+'" title="'+d.product.name+'"><img src="'+c+a[0]+"?r="+j+'" ></a></li>',a.forEach(function(a,b){b>0&&(f+=' <li class="image-additional image-thumb"><a rel="magnific" class="thumbnail" href="'+c+a+"?r="+j+'" > <img src="'+c+a+"?r="+j+'" ></a></li>')}),b(x).html(f),b('a[rel="magnific"]').magnificPopup({type:"image",gallery:{enabled:!0}})):b(".image").length&&b.colorbox&&(b(".image").html('<a href="'+c+a[0]+"?r="+j+'" title="'+d.product.name+'" class="colorbox cboxElement"><img width="'+(b(".image").width()||300)+'" src="'+c+a[0]+"?r="+j+'" title="" alt="" id="image"></a>'),f="",a.forEach(function(a,b){b>0&&(f+=' <a href="'+c+a+"?r="+j+'" title="" class="colorbox cboxElement"><img width="76" src="'+c+a+"?r="+j+'" title="" alt=""></a>')}),b(".image-additional").html(f),b(".zoomContainer").remove(),b(".colorbox").colorbox({rel:"colorbox"}));break;case"ps":b.fancybox&&setTimeout(function(){b(document).unbind("click.fb-start"),b(".fancybox").unbind("click.fb"),b(".fancybox_").unbind("click.fb"),b("#image-block,#image-block").html('<a rel="fb__" class="fancybox_" href="'+(c+a[0])+'"><img id="bigpic" itemprop="image" src="'+(c+a[0])+'" width="458"></a>'),b("#thumbs_list,#views_block").html("").append('<ul id="thumbs__" style="width: 297px;"></ul>');for(var d=1;d<a.length;d++)b("#thumbs__").append('<li><a rel="fb__" href="'+(c+a[d])+'" class="fancybox_"><img itemprop="image" src="'+(c+a[d])+'" width="80"></a></li>');b("#thumbs_list").parent().removeClass("hidden"),b(".fancybox_").fancybox(),b(".resetimg,.view_scroll_spacer").hide()},2e3);break;case"sp":setTimeout(function(){b(document).unbind("click.fb-start"),b(y).unbind("click.fb").unbind("click"),b(s).first().html('<a rel="_imgs" id="placeholder" href="'+c+a[0]+'" class="fancybox_ zoom colorbox cboxElement"><img itemprop="image" src="'+c+a[0]+'" class="ppc-img-width" ></a>'),f="",a.forEach(function(a,b){b>0&&(f+='<div rel="_imgs" class="fancybox_ image span2 colorbox cboxElement"><a href="'+c+a+'" data-original-image="'+c+f+'"><img src="'+c+f+'" alt="'+d.product.name+'"></a></div>')}),b(w).append(f),"undefined"!=typeof b.fancybox?b(".fancybox_").fancybox():"undefined"!=typeof b.colorbox&&b(".colorbox").colorbox({rel:"_imgs"})},2e3);break;case"mg":}}},c.clearDesign=function(){i.attr("disabled","disabled"),e.attr("disabled","disabled"),c.saveSess({clear:!0})},c.saveSess=function(a){"ps"===d.client&&(a.ajax=!0),"sp"===d.client&&(a.productId=d.product.id,a.connectsid=d.connectsid),c.comm(c.getSavePath(d.product.id),function(b){(a.clear||"ps"===d.client)&&window.location.reload()},function(a){},a,"POST",a.clear?"text":"json","sp"===d.client)},c.duplicateProject=function(a){if(isNaN(parseInt(a)))a=JSON.parse(decodeURIComponent(a));else{var e=d.designs[parseInt(a)];a={projectId:e.id,numPages:e.pages,meta:{},userId:d.userId,product:e.product,designId:e.designId,type:"p"}}var f=a.product.id;c.comm(d.apiBase+"clone-project",function(b){b.error?c.alert(new Error("Error duplicating project!")):(a.projectId=b.newId,c.comm(c.getSavePath(f,a),function(a){window.location=a.trim().replace(/&amp;/g,"&")},function(a){c.alert(a)},{clone:!0,values:encodeURIComponent(JSON.stringify(a)),ajax:!0},"POST","text"))},function(a){c.alert(a)},{values:1,projectId:a.projectId||a.projectID,connectsid:d.connectsid},"POST","json",!0);var g=b("#my_recent_des_div");return g.length&&(g.children().hide(),g.prepend('<img src="'+d.cdnBase+'images/loaders/spinner.svg" >')),!1},c.getSavePath=function(a,b){switch(d.client){case"wp":return d.pluginRoot+"app/saveproject.php?productId="+a;case"oc":return(d.self||"index.php?route=product/product&product_id="+a)+"&productId="+a;case"ps":return b?b.product.url:window.location;case"sp":return d.apiBase+"sp-save-session";case"mg":}},c.viewDesign=function(a){if(d.designs){if(d.designs[a]){for(var c=[],e=0;e<d.designs[a].pages;e++)c.push(d.rscBase+"images/previews/"+d.designs[a].id+"_"+(e+1)+".jpg");b.prettyPhoto?b.prettyPhoto.open(c):b.magnificPopup?(c.forEach(function(a,b){c[b]={src:a}}),b.magnificPopup.open({items:c,type:"image",gallery:{enabled:!0}})):b.colorbox&&(b("body").append('<div id="pp_cb_div" style="display:none"></div>'),c.forEach(function(a){b("#pp_cb_div").append('<a href="'+a+'" rel="pp-cb-rel" class="pp-cb-rel" ></a>')}),b("a.pp-cb-rel").colorbox({open:!0,rel:"pp-cb-rel",onClosed:function(){b("#pp_cb_div").remove()}}))}return!1}},c.deleteProject=function(a){return confirm(d.lang.delete_message)&&(b("#my_recent_des_div").html('<img src="'+d.cdnBase+'images/loaders/spinner.svg" >'),c.comm(d.apiBase+"delete-project",function(a){c.fetchUserProjects()},function(a){c.alert(a)},{projectId:a,connectsid:d.connectsid},"POST","json",!0)),!1},c.fetchUserProjects=c.fetchUserDesigns=function(){var a=b("#pp_mydesigns_div");a.length&&(b("#my_recent_des_div").length||a.append('<div><h2 pp-lang="text_my_recent">'+(d.lang?d.lang.text_my_recent:"")+'</h2><div id="my_recent_des_div"><img src="'+d.cdnBase+'images/loaders/spinner.svg" border="0" ><br/><br/></div></div>'),c.comm(d.apiBase+"fetch-recent",function(a){if("function"==typeof d.functions.myRecentDesigns)return d.functions.myRecentDesigns(a);a.reverse(),d.designs=a;var c="";0===a.length?c=d.lang.sorry_no_project:(c+='<table class="shop_table my_account_orders table table-bordered table-hover"><tbody>',a.forEach(function(a,b){c+='<tr class="order"><td class="pp-cntr"><img src="'+d.rscBase+"images/previews/"+a.id+'_1.jpg" class="pp-90thumb" ></td><td class="pp-cntr" width="180" title="Modified '+a.lastModified+'">'+(a.product.name||a.product.title)+'</td><td class="pp-cntr"><a class="button btn btn-success" onclick="return PPCLIENT.duplicateProject('+b+')" href=""><span pp-lang="duplicate_design_for_reorder">'+(d.lang?d.lang.duplicate_design_for_reorder:"")+'</a></td><td class="pp-cntr"><a class="button btn btn-default" onclick="return PPCLIENT.viewDesign('+b+')" href=""><img src="'+d.cdnBase+"images/"+(d.icnView||"eye.png")+'" border="0" ></a></td><td class="pp-cntr"><a class="button btn btn-default" onclick="return PPCLIENT.deleteProject(\''+a.id+'\')" href=""><img src="'+d.cdnBase+"images/"+(d.icnDelete||"cross.png")+'" border="0" ></a></td></tr>'}),c+="</tbody></table>"),b("#my_recent_des_div").html(c)},function(a){c.alert(a)},{connectsid:d.connectsid},"POST","json",!0))},c.showBusy=function(){c.showModal('<div class="ppc-blockui-div" ><img src="'+d.cdnBase+'images/loaders/spinner.svg" ></div>')},c.showModal=function(a){b.blockUI({message:a,css:{padding:"0",margin:"0",width:"100%",left:"0",right:"0",top:"0",bottom:"0",textAlign:"center",background:"rgba(0,0,0,0)",border:"none",cursor:"default"},overlayCSS:{cursor:"default",opacity:.5},baseZ:9999999})},c.isValidPP=function(a){if(!a||""===a)return!1;try{var b=JSON.parse(decodeURIComponent(a));return!(!b.type||!b.product)}catch(c){return!1}return!0},c.alert=function(a){console.log("PitchPrint: "+a)},c.start=function(){c.readyFncs&&(c.readyFncs.forEach(function(a){c[a]()}),c.readyFncs=[])},c.start()}(this);